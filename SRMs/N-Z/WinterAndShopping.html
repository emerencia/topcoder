<html><body bgcolor="#ffffff" text="#000000"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>
It's winter time!
Time to do some shopping.
</p>
<p>
</p>
<p>
You want to buy some colored balls.
The only balls that are on the market nowadays are red, green and blue balls.
There are several shops in your city.
You are given four vector &lt;int&gt;'s <b>first</b>, <b>red</b>, <b>green</b> and <b>blue</b>.
For each i, the i-th shop starts working on <b>first</b>[i]-th day, works for <b>red</b>[i]+<b>green</b>[i]+<b>blue</b>[i] consecutive days and sells exactly <b>red</b>[i] red balls, <b>green</b>[i] green balls, <b>blue</b>[i] blue balls.
Each shop sells exactly one ball on each day it is working.
</p>
<p>
</p>
<p>
You also know that the opening days and numbers of balls are such that on any given day at most two shops will be open.
Additionally, if there are two shops open on the same day, they are required to sell balls of the same color.
You want to know the number X of different orders in which the shops can sell the balls.
(Two selling orders are considered different if there is a day and a shop such that in one order the shop sold a ball of a different color than in the other.)
Return the value (X modulo 1,000,000,007).
</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>WinterAndShopping</td></tr><tr><td>Method:</td><td>getNumber</td></tr><tr><td>Parameters:</td><td>vector &lt;int&gt;, vector &lt;int&gt;, vector &lt;int&gt;, vector &lt;int&gt;</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int getNumber(vector &lt;int&gt; first, vector &lt;int&gt; red, vector &lt;int&gt; green, vector &lt;int&gt; blue)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>first</b>, <b>red</b>, <b>green</b> and <b>blue</b> will contain between 1 and 50 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>first</b>, <b>red</b>, <b>green</b> and <b>blue</b> will contain the same number of elements.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>first</b> will be between 1 and 500, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>red</b>, <b>green</b> and <b>blue</b> will be between 0 and 100, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>For each valid i, the value <b>red</b>[i]+<b>green</b>[i]+<b>blue</b>[i] will be strictly greater than 0.</td></tr><tr><td align="center" valign="top">-</td><td>For each valid i, the value <b>first</b>[i]+<b>red</b>[i]+<b>green</b>[i]+<b>blue</b>[i]-1 will be less than or equal to 500.</td></tr><tr><td align="center" valign="top">-</td><td>For each day, at most two shops will be opened.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1}</pre></td></tr><tr><td><pre>{1}</pre></td></tr><tr><td><pre>{1}</pre></td></tr><tr><td><pre>{1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 6</pre></td></tr><tr><td><table><tr><td colspan="2">There is one shop in this case, selling three different balls in three days. All permutations are possible, thus the answer is 6.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1}</pre></td></tr><tr><td><pre>{3}</pre></td></tr><tr><td><pre>{0}</pre></td></tr><tr><td><pre>{0}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2">In this case, the shop is selling only balls of red color. Thus, there is only one possibility.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1, 2}</pre></td></tr><tr><td><pre>{1, 1}</pre></td></tr><tr><td><pre>{1, 1}</pre></td></tr><tr><td><pre>{1, 1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 6</pre></td></tr><tr><td><table><tr><td colspan="2">One of the six valid orders in which all balls can be sold: The first shop sells a red ball, then a blue one, and finally a green one. The second shop (which opens a day later) first sells a blue ball, then a green one, and finally the remaining red one.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{47, 47}</pre></td></tr><tr><td><pre>{1, 0}</pre></td></tr><tr><td><pre>{0, 1}</pre></td></tr><tr><td><pre>{0, 0}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2">Both stores are open on the same day. However, one store only has a red ball and the other store only has a green ball. The balls don't have the same color, thus the stores cannot sell them on the same day. Hence there is no valid way to sell the balls. In such a case the correct return value is obviously 0.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1, 100, 200}</pre></td></tr><tr><td><pre>{100, 1, 0}</pre></td></tr><tr><td><pre>{100, 3, 7}</pre></td></tr><tr><td><pre>{100, 2, 4}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 79290907</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">5)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1, 3}</pre></td></tr><tr><td><pre>{3, 4}</pre></td></tr><tr><td><pre>{4, 4}</pre></td></tr><tr><td><pre>{2, 1}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 840</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">6)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{2, 1}</pre></td></tr><tr><td><pre>{100, 100}</pre></td></tr><tr><td><pre>{100, 100}</pre></td></tr><tr><td><pre>{99, 100}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 412784747</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">7)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{1, 220, 150}</pre></td></tr><tr><td><pre>{70, 70, 50}</pre></td></tr><tr><td><pre>{70, 70, 50}</pre></td></tr><tr><td><pre>{70, 70, 50}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 291495139</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">8)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{2, 2, 70, 159}</pre></td></tr><tr><td><pre>{100, 20, 21, 52}</pre></td></tr><tr><td><pre>{100, 20, 29, 45}</pre></td></tr><tr><td><pre>{100, 22, 39, 30}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 139586270</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
