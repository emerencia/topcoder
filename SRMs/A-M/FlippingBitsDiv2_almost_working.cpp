#include <string>
#include <iostream>
#include <sstream>
#include <algorithm>
#include <vector>
#include <map>
#include <set>
#include <queue>
#include <cmath>
#include <utility>
#include <climits>
#include <cstring>
#include <numeric>
using namespace std;
typedef pair<int,int> PII;
typedef long long LL;

const int totest = -1;

class FlippingBitsDiv2 {
 public:
  string removeRepetitions(string s) {
    string a;
    char c = 0;
    for (int i=0;i<s.size();i++) {
      if (s[i] == c) continue;
      c = s[i];
      a+= c;
    }
    return a;
  }
  int getmin(vector <string> S, int M) {
    string s = accumulate(S.begin(),S.end(),string(""));
    string majority;
    int forcedflips = INT_MAX;
    for (int nprev = 0;nprev < 2; nprev++) {
      int prev = nprev;
      int tforcedflips = 0;
      string tmajority;
      bool swaps = true;
      for (int i=0;i<s.size();i+=M) {
        int zerocount = 0;
        for (int d=0;d<M;d++) {
          zerocount += (s[i+d] == '0');
        }
        tforcedflips += min(zerocount,M-zerocount);
        if (zerocount == M-zerocount) {
          tmajority.push_back(prev+'0');
          tforcedflips-= min(zerocount,M-zerocount);
          tforcedflips+=zerocount;
        } else if (zerocount > M-zerocount) {
          tmajority.push_back('0');
          if (prev != 0) { 
            if (swaps) tforcedflips++;
            swaps = true;
          }
          prev = 0;
        } else {
          tmajority.push_back('1');
          if (prev != 1) { 
            if (swaps) tforcedflips++;
            swaps = true;
          }
          prev = 1;
        }
      }
      if (tforcedflips < forcedflips) {
        majority = tmajority;
        forcedflips = tforcedflips;
      }
    }
    /*
    int leftandright = 0;
    char last = '?';
    char secondtolast = '?';
    for (int i=0;i<majority.size();i++) {
      if (majority[i] == '?' || majority[i] == last) continue;
      if (last != '?' && secondtolast != '?' &&
          secondtolast != last && last != majority[i]) {
        leftandright++;
      }
      secondtolast = last;
      last = majority[i];
    }
    string filtered = majority;
    filtered.resize(remove(filtered.begin(),filtered.end(),'?')-filtered.begin());
    if (forcedflips || filtered.find('0') != string::npos)
      leftandright++;
    string rmajor = removeRepetitions(majority);
    int leftandrightn = (rmajor.find('0') == string::npos ? rmajor.size() : rmajor.size()-1);
    cout << majority << endl;
    cout << rmajor << endl;
    cout << forcedflips << " " << leftandright << " " << leftandrightn << endl;
    int totalflips = forcedflips+leftandright;
    return totalflips;
    */
    return forcedflips;
  }
  
// BEGIN CUT HERE
  // 02:01-02:12
	public:
	void run_test(int Case) { if ((Case == -1) || (Case == 0)) test_case_0(); if ((Case == -1) || (Case == 1)) test_case_1(); if ((Case == -1) || (Case == 2)) test_case_2(); if ((Case == -1) || (Case == 3)) test_case_3(); if ((Case == -1) || (Case == 4)) test_case_4(); if ((Case == -1) || (Case == 5)) test_case_5(); if ((Case == -1) || (Case == 6)) test_case_6(); if ((Case == -1) || (Case == 7)) test_case_7(); }
	private:
	template <typename T> string print_array(const vector<T> &V) { ostringstream os; os << "{ "; for (typename vector<T>::const_iterator iter = V.begin(); iter != V.end(); ++iter) os << '\"' << *iter << "\","; os << " }"; return os.str(); }
	void verify_case(int Case, const int &Expected, const int &Received) { cerr << "Test Case #" << Case << "..."; if (Expected == Received) cerr << "PASSED" << endl; else { cerr << "FAILED" << endl; cerr << "\tExpected: \"" << Expected << '\"' << endl; cerr << "\tReceived: \"" << Received << '\"' << endl; } }
	void test_case_0() { string Arr0[] = {"00111000"}; vector <string> Arg0(Arr0, Arr0 + (sizeof(Arr0) / sizeof(Arr0[0]))); int Arg1 = 1; int Arg2 = 2; verify_case(0, Arg2, getmin(Arg0, Arg1)); }
	void test_case_1() { string Arr0[] = {"00111000"}; vector <string> Arg0(Arr0, Arr0 + (sizeof(Arr0) / sizeof(Arr0[0]))); int Arg1 = 2; int Arg2 = 3; verify_case(1, Arg2, getmin(Arg0, Arg1)); }
	void test_case_2() { string Arr0[] = {"111111"}; vector <string> Arg0(Arr0, Arr0 + (sizeof(Arr0) / sizeof(Arr0[0]))); int Arg1 = 3; int Arg2 = 0; verify_case(2, Arg2, getmin(Arg0, Arg1)); }
	void test_case_3() { string Arr0[] = {"00100"}; vector <string> Arg0(Arr0, Arr0 + (sizeof(Arr0) / sizeof(Arr0[0]))); int Arg1 = 5; int Arg2 = 2; verify_case(3, Arg2, getmin(Arg0, Arg1)); }
	void test_case_4() { string Arr0[] = {"00010","11010110","1010111","110001010","0110001100"
,"000110110","011010101","00","111","100"}
; vector <string> Arg0(Arr0, Arr0 + (sizeof(Arr0) / sizeof(Arr0[0]))); int Arg1 = 13; int Arg2 = 31; verify_case(4, Arg2, getmin(Arg0, Arg1)); }
  void test_case_5() { string Arr0[] = {"00100001100011000000000000000100101000100000"}
; vector <string> Arg0(Arr0, Arr0 + (sizeof(Arr0) / sizeof(Arr0[0]))); int Arg1 = 11; int Arg2 = 10; verify_case(5, Arg2, getmin(Arg0, Arg1)); }
  void test_case_6() { string Arr0[] = {"01011011100001111010001100100111110100100000011101", "00110011101111100010111100001101001011110100000010", "00001000100111010110111010001100111000011011010010", "10011101110100001101110111110100001110011100010010", "11110010100110011111010001000101000100100000000011", "10110101110101101001001001000000010011010010110010", "11001011011101111100000111000100010110110101101001", "01010010100011001101011100101110101100100001011101", "10100101011010010010110110110110101110110101110111", "00111100100010010101011011000011100011010011011110", "11100010100111000001010010101101001110010000000000", "01000101001011001011001011010111011010001000001011", "11001110001001000111100110110011000010010011001010", "00100111000001010110111100110111001100011110111000", "10111111100010101101011101000010011110111101010011", "01100101100101011001001100011010101101111101000100", "00011000100101000001110001100011100100100110010110", "10010010001010101111000001110011111110101111100000", "10111000110000011010010011000000001001011011001101", "01100101111011010111111001001100101010100010011001", "11000110111010001010101100110111110011110100100110", "00001010111100101110010010010100100101000010011000", "11100010110100001110011101001010100111001011001000", "00011111001011110101001001111000000110101001010111", "11001010111010110001001011000110111000001111110000", "10000010000011100101011111100000111101011000001011", "00111010010000101001101110001101100001100111100101", "01100111011001001000010111100011111001011111000000", "10100110001100011001101100111110000100110100010010", "00111001000111000111100111000100100010000001010010", "11011010000101111010100000010110110000001010001110", "01100111000001110101001100100101111000101010101000", "11001101001011001010101111000011111011011011111011", "10100101101100111001111010001001010100100001111010", "01011010110100000101010010100001100111000111100110", "10110001100010101111010100000010001001111111010000", "00000000000000011101001011000001111001100100011101", "11100000010010010110110110110110011000010011010000", "11111000010111100111100110111101110111111011010110", "00101111100110100111001101001010010101100100110010", "11111000001100000011110000100110010100011001101010", "00101110001010010011001001010011100111101010110110", "11010011101010000101100011110101011010100000000111", "00011101001000001011100000000110000111110011010010", "00010110011101001011010100010100001100110010100011", "01000000000100111111011001111010001110110010010001", "11100010010011001010010010010010101001001010100110", "00111000001100110101100101001000110100110110011100", "00110001100111000100101100101100010110101100110000", "10101011101110111100000111100000011110010011000110"}

; vector <string> Arg0(Arr0, Arr0 + (sizeof(Arr0) / sizeof(Arr0[0]))); int Arg1 = 2; int Arg2 = 979; verify_case(6, Arg2, getmin(Arg0, Arg1)); }
  void test_case_7() { string Arr0[] = {"00000110110000011001100001110010101000001111000101", "00101100111110001000101111101010101011010011111001", "01011010001000110101000011011101101011010111101100", "00010111011110001101111000001110010100000111000100", "10111001001111101010011111010111110010100001010100", "11110000101100000100000001100100100111101011100100", "10000011111110101111111101001111100000001100101100", "10110011000111100101000000001110101100000010101100", "10101011000101101101101011101101011100110110001111", "10000011101001010110011011010001111000001011001100", "10011000111111010100100011000110000011011001101110", "11111110001011110000010101000111001110100111101110", "01010010100100111100111101100100010011010011101011", "11000111111110011100111110011001001110001010110011", "00100011011011101001101010101010101111010101001010", "00101011111110001010011101111100111010000000010111", "11001110011000000110101010010110011011000100011000", "00110000111100011100011101011001001111111011111011", "00111000010110010001110000110111011000011000110101", "00011101001010100101001110010111001000100011110111", "01011111001001110001011000001111011101111100111101", "00001111000000010110010100000111111010100110111010", "00010101101101101101000010101110001010100110011000", "10000011000110111011001001001010001101000010010001", "01001100111001010110101000111101011001100100101011", "00000100110010111001100100010111111000100110001011", "00100100111110010011000010010010001001101110100101", "00100110110111000110111101000100011000001001110010", "10010100101110101100111110010010011010011010000001", "00110011111001010110000110000010010000001110010111", "10001100111010100001100111110110000010000111010000", "10100000101100111010110100100011110000001110101000", "11011010111001011000101111001001001111001101111100", "11000100111001011100000111101001111101011011000110", "11011111000111110010110110101101000110011000111110", "01101000111110010010111001011010000101100101101001", "01100110011010111010000100100111010000100001000100", "00100110100110000111011000100000000010111100000110", "00100001011011101011011110110101101101101000101111", "11000111000101001110011000100100100011001100010111", "10110001101010111111110000011011101010001000110000", "11111010110000001110101111010011100101111111001011", "10110001010000100001000001100000000101011010111110", "01100000111011111000100011110011000001000111110110", "00011101000000101101101011001001100010001101001000", "01010010101011100100110100111011000110010111000011", "00011001100101101111000111110011001000001111011011", "01111110101110110010000110001100110000101001011110", "01000011100011100111011011010101000001010100000110", "10111100010001111011010101001010011100001011101110"}
; vector <string> Arg0(Arr0, Arr0 + (sizeof(Arr0) / sizeof(Arr0[0]))); int Arg1 = 25; int Arg2 = 1108; verify_case(7, Arg2, getmin(Arg0, Arg1)); }
// END CUT HERE

};
// BEGIN CUT HERE
int main() {
  FlippingBitsDiv2 ___test;
  ___test.run_test(totest);
}
// END CUT HERE
